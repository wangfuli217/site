#+SETUPFILE: ~/site/tpl/wiki-tpl.org
#+TITLE: Emacs 快捷键
#+DATE: 2020-03-28 17:20:19

#+begin_quote
Emacs 被人诟病除了复杂的快捷键之外，就是 =Ctrl= 伤小拇指，几乎所有的快捷键都是以 =Ctrl= 或者 =Alt= 开始的。
于我而言，这倒不是关键（小拇指目前很健康），但是不同键盘的 Ctrl 键位置不同，这就很难受了。

有些使用 [[https://github.com/emacs-evil/evil][evil]] 来达到 Emacs 和 Vim 双修，弥补 Emacs 快捷键操作的缺陷，兼具 Emacs 和 Vim 的优点。目前出名的
Emacs kit 如 Spacemacs、DoomEmacs 都是这样。然而，我 Vim 用的不溜，没办法一开始就用的是 Emacs，而不是 Vim。

除了 evil 之外，[[https://github.com/xahlee/xah-fly-keys][xah-fly-keys]] 就是专门用来解决这个问题的，我试了，映射方式太变态了，而且文档很少，自定义比较麻烦。

我选择了 [[https://github.com/abo-abo/hydra][hydra]]，hydra 并不是像 xah-fly-keys 一样专项解决键映射问题，但是顺带可以解决了。选择 hydra 还有一点
是比较信任它的作者 abo-abo，他有几个开源的插件，著名的 swiper、avy、ace-windows 我都用了。
#+end_quote

hydra 只是以一个快捷键前缀开始重映射快捷键。但是 Emacs 的快捷键太多了，键盘上主功能区域的键基本上都用完了。
作为 Leader Key，如果再以 =Ctrl= 开始的话，就没有做映射的必要了。

我的目标并不是想做到像 Vim 一样区分模式编辑，而是减少 =Ctrl= 的使用频率，而使用使用更加合理的方式来编排所有
的快捷键（之前的快捷键编排不合理导致新增快捷键混乱，没有统一的规范）。

快捷键一般都是复合的键，由 Leader 键和操作键组合而成。主键盘区无论使用 =C-c= 作为前缀，还是 =M-;= 作为前缀
都会影响正常的快捷键使用，而且我并不想重新映射 =M= 开头的快捷键。

所以 Leader 键只能放到了功能键: =<f1> ~ <f12>= ，又因为如果统一使用一个前缀的话，单手复合快捷键操作起来并不
舒服，比如 =F2-o= 映射为打开文件就很顺手， =F2-w= 映射为保存文件操作起来就有点难受了。

因此，我的映射方法是将键盘按照左手、右手分开。如果操作键是右手区，那么 Leader 键就用左手区的，反之亦然。

这样，所有键盘上的 26 个字母大小写，以及标点符号都可以作为快捷键来使用了。

--------------------

*注意：下面的快捷键大多都是重新定义过的，与 Emacs 的默认快捷键不同。*


* 基于 =F2= 开始

|--------+-------------------------------------+---------------------------------------------------------|
| 复合键 | 绑定函数                            | 说明                                                    |
|--------+-------------------------------------+---------------------------------------------------------|
| =0=    | =delete-window=                     | 关闭当前窗口                                            |
| =-=    | =shrink-window-horizontally=        | 水平缩小当前窗口大小                                    |
| ~=~    | =shrink-window=                     | 垂直减小当前窗口大小                                    |
| =_=    | =enlarge-window-horizontally=       | 水平扩大当前窗口大小                                    |
| =+=    | =enlarge-window=                    | 垂直扩大当前窗口大小                                    |
|--------+-------------------------------------+---------------------------------------------------------|
| =u=    | =undo=                              | 撤销                                                    |
| =it=   | =insert-current-date-time=          | 插入当前时间，比如 <2020-03-27 21:59:04> 函数是自定义的 |
| =o=    | =counsel-find-file=                 | 打开文件                                                |
| =pi=   | =projectile-invalidate-cache=       |                                                         |
| =pp=   | =counsel-projectile-switch-project= | 切换项目                                                |
| =pf=   | =counsel-projectile-find-file=      | 项目中查找文件                                          |
| =[=    | =beginning-of-buffer=               | 到文件首                                                |
| =]=    | =end-of-buffer=                     | 到文件尾                                                |
|--------+-------------------------------------+---------------------------------------------------------|
| =k=    | =kill-buffer=                       |                                                         |
| =l=    | =display-line-numbers-mode=         |                                                         |
|--------+-------------------------------------+---------------------------------------------------------|
| =m=    | =counsel-semantic-or-imenu=         |                                                         |
|--------+-------------------------------------+---------------------------------------------------------|
| =<f2>= | nil                                 | 退出 hydra                                              |
|--------+-------------------------------------+---------------------------------------------------------|

* 基于 =F8= 开始

|--------+------------------------------+-------------------------|
| 复合键 | 绑定函数                     | 说明                    |
|--------+------------------------------+-------------------------|
| =1=    | =delete-other-windows=       |                         |
| =2=    | =split-window-below=         |                         |
| =3=    | =split-window-right=         |                         |
|--------+------------------------------+-------------------------|
| =w=    | =save-buffer=                | 保存                    |
| =r=    | =ivy-resume=                 |                         |
|--------+------------------------------+-------------------------|
| =a=    | =mark-whole-buffer=          | 全选                    |
| =ss=   | =swiper=                     | 本文档搜索              |
| =sd=   | =counsel-ag=                 | 项目目录中搜索，使用 ag |
| =dp=   | =show-file-name=             | 显示当前文件路径        |
| =f=    | =ivy-switch-buffer=          | 切换 buffer             |
|--------+------------------------------+-------------------------|
| =x=    | =eshell=                     |                         |
| =c=    | =save-buffers-kill-terminal= | 关闭 Emacs              |
| =v=    | =scroll-up-command=          | 向下滚动                |
|--------+------------------------------+-------------------------|
| =<f8>= | nil                          | 退出 hydra              |
|--------+------------------------------+-------------------------|

* 基于 =M= 开始

| 复合键              | 函数                        | 说明                   |
| =-=                 | =highlight-symbol-at-point= | 在全文档中高亮当前单词 |
| =m=                 | =er/expand-region=          | expand-region          |
| =y=                 | =counsel-yank-pop=          | 粘贴历史               |
| =o 1/2/3/4/7/8/9/0= | =ace-window=                | 选择 frame             |
|                     |                             |                        |

* 基于 =M-s= 开始

| 复合键 | 函数                                     | 说明                             |
| =s=    | =er/mark-symbol=                         | 选中当前单词                     |
| =;=    | =mc/mark-all-symbols-like-this-in-defun= | [多鼠标编辑] 选中当前函数中      |
| =f=    | =er/mark-defun=                          | 选中当前函数                     |
| =i=    | =avy-goto-word-1=                        | 跳转到指定字符开始的单词         |
| =j=    | =avy-goto-line=                          | 跳转到行                         |
| =k=    | =avy-copy-line=                          | 复制指定行到当前                 |
| =m=    | =er/mark-comment=                        | 选中注释                         |
| =p=    | =er/mark-outside-pairs=                  | 选中括号内容(包含括号自身)       |
| =P=    | =er/mark-inside-pairs=                   | 选中括号内容(不包含括号自身)     |
| =>=    | =mc/mark-next-like-this=                 | [多鼠标编辑] 选中后一个          |
| =<=    | =mc/mark-previous-like-this=             | [多鼠标编辑] 选中前一个          |
| =C-a=  | =mc/mark-all-like-this=                  | [多鼠标编辑] 选中所有            |
| =.=    | =swiper-isearch-thing-at-point=          | 当前 buffer 搜索当前光标所在单词 |
| =t=    | =ace-swap-window=                        | 窗口位置交换                     |


* 基于 =C-x= 开始

|--------+-----------------------------+------------------|
| 快捷键 | 函数                        | 说明             |
|--------+-----------------------------+------------------|
| =g=    | =git-gutter+-mode=          | 打开 git-gutter+ |
| =n/p=  | =git-gutter+-previous-hunk= | 上一个 git 改动  |
|        | =git-gutter+-next-hunk=     | 下一个 git 改动  |
|--------+-----------------------------+------------------|
| =r=    | =git-gutter+-revert-hunks=  | git revert       |
| ~v =~  | =vc-diff=                   | vc diff          |
| =v l=  | =vc-print-log=              | vc 日志          |
|--------+-----------------------------+------------------|
